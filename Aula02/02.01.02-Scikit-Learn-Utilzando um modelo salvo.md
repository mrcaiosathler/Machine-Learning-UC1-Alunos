#  Scikit-Learn - Utilizando um modelo treinado

> O objetivo principal √© a elabora√ß√£o de um c√≥digo para **usar um modelo de Machine Learning j√° treinado para preencher dados faltantes em um novo dataset**. 
>
> Vamos supor que temos um conjunto de dados com informa√ß√µes de alunos (como idade, renda, cidade, nota etc.) e queremos **prever uma categoria** (por exemplo: se o aluno foi aprovado ou reprovado, ou qual tipo de bolsa ele pode receber) com base nas outras informa√ß√µes.

## üìå Estrutura Geral do C√≥digo

1. **Carregar o modelo salvo**
2. **Ler o novo dataset**
3. **Separar colunas por tipo (num√©ricas e categ√≥ricas)**
4. **Preencher valores faltantes (imputa√ß√£o)**
5. **Transformar vari√°veis categ√≥ricas em n√∫meros (One-Hot Encoding)**
6. **Padronizar os dados num√©ricos**
7. **Usar o modelo para fazer previs√µes**
8. **Adicionar as previs√µes no dataset original**
9. **Mostrar o resultado final**


### üîπ 0. Carregando as bibliotecas

:snake: **C√≥digo**:
```python
import pandas as pd
import numpy as np
from sklearn.preprocessing import OneHotEncoder, StandardScaler
from sklearn.impute import SimpleImputer
from sklearn.compose import ColumnTransformer
from joblib import load
```

#### üîπ `OneHotEncoder`
- **Finalidade:** Transformar vari√°veis categ√≥ricas (como "S√£o Paulo", "Rio") em n√∫meros (0 e 1), para que o modelo de ML possa entender.
- **Exemplo:** Converte `"cidade"` em colunas como `"cidade_Sao_Paulo"`, `"cidade_Rio"` etc.

#### üîπ `StandardScaler`
- **Finalidade:** Padronizar os valores num√©ricos, deixando todos na mesma escala (m√©dia = 0 e desvio padr√£o = 1).
- **Import√¢ncia:** Alguns modelos aprendem melhor quando os n√∫meros est√£o equilibrados.

#### üîπ `SimpleImputer`
- **Finalidade:** Preencher valores faltantes (`NaN`) nos dados num√©ricos.
- **Como:** Substitui por m√©dia, mediana ou outro valor fixo.

#### üîπ `ColumnTransformer`
- **Finalidade:** Aplicar diferentes transforma√ß√µes em diferentes colunas do dataset ao mesmo tempo.
- **Exemplo:** Aplicar `StandardScaler` nas colunas num√©ricas e `OneHotEncoder` nas categ√≥ricas.

> üìå **Nota:** Esse m√≥dulo foi importado, mas **n√£o foi usado no c√≥digo original**. Ele √© √∫til para automatizar e organizar as etapas de pr√©-processamento.

#### üîπ `joblib.load`
- **Finalidade:** Carregar um modelo de Machine Learning que foi salvo anteriormente.
- **Uso comum:** Ap√≥s treinar um modelo, ele pode ser salvo e depois recarregado para fazer previs√µes sem precisar trein√°-lo de novo.

#### ‚úÖ Resumo Final

| M√≥dulo | O que faz |
|-------|-----------|
| `OneHotEncoder` | Transforma texto em n√∫meros |
| `StandardScaler` | Deixa n√∫meros na mesma escala |
| `SimpleImputer` | Preenche campos vazios |
| `ColumnTransformer` | Aplica transforma√ß√µes espec√≠ficas por tipo de coluna |
| `joblib.load` | Carrega um modelo j√° treinado |

### üîπ 1. Carregar o modelo salvo

:snake: **C√≥digo**:
```python
modelo = load('modelo_regressao_logistica.joblib')
```

- Aqui estamos carregando um **modelo de Machine Learning j√° treinado**, que foi salvo anteriormente com o nome `modelo_regressao_logistica.joblib`.
- A fun√ß√£o `load()` do m√≥dulo `joblib` serve para carregar modelos que foram salvos com `dump()` depois do treinamento.
- Esse modelo vai ser usado para **fazer previs√µes** em novos dados.

---

### üîπ 2. Ler o novo dataset

```python
df_novo = pd.read_csv('novo_dados.csv')
```

- Estamos lendo um arquivo `.csv` chamado `novo_dados.csv` usando o Pandas (`pd.read_csv`).
- Esse √© o **conjunto de dados onde falta alguma informa√ß√£o** que queremos prever.
- Por exemplo, talvez a coluna `"categoria"` esteja vazia ou ausente, e queremos usar o modelo para complet√°-la.

---

### üîπ 3. Separar colunas por tipo

```python
colunas_numericas = ['idade', 'renda', 'nota']
colunas_categoricas = ['cidade', 'categoria', 'feedback']
```

- Separamos as colunas do dataset em dois grupos:
  - **Num√©ricas**: que t√™m valores como n√∫meros (ex: idade, renda, nota)
  - **Categ√≥ricas**: que t√™m valores como textos ou categorias (ex: cidade, feedback)

Essa separa√ß√£o √© importante porque **precisamos preparar os dados de formas diferentes** dependendo do tipo.

---

### üîπ 4. Imputa√ß√£o de valores faltantes

```python
imputer = SimpleImputer(strategy='mean')
df_novo[colunas_numericas] = imputer.fit_transform(df_novo[colunas_numericas])
```

- Valores faltantes s√£o aqueles que est√£o vazios ou com `NaN` (Not a Number).
- Usamos o `SimpleImputer` com estrat√©gia `'mean'` para **substituir esses valores pela m√©dia** das colunas num√©ricas.
- Isso √© necess√°rio pois modelos de ML **n√£o aceitam valores faltantes**.

---

### üîπ 5. One-Hot Encoding das vari√°veis categ√≥ricas

```python
encoder = OneHotEncoder(handle_unknown='ignore', sparse_output=False)
categorias_codificadas = encoder.fit_transform(df_novo[colunas_categoricas])

df_categorias = pd.DataFrame(categorias_codificadas, columns=encoder.get_feature_names_out(colunas_categoricas))
df_processado = pd.concat([df_novo.reset_index(drop=True), df_categorias], axis=1)
df_processado.drop(colunas_categoricas, axis=1, inplace=True)
```

- Modelos de ML **n√£o entendem texto diretamente**. Ent√£o precisamos transformar palavras em n√∫meros.
- O `OneHotEncoder` cria **colunas bin√°rias (0 ou 1)** para representar cada categoria.
  - Exemplo: Se a coluna `"cidade"` tem os valores `"S√£o Paulo"`, `"Rio"`, `"Curitiba"`, ele cria tr√™s colunas: `cidade_S√£o Paulo`, `cidade_Rio`, `cidade_Curitiba`.

> ‚ö†Ô∏è Importante: usamos `handle_unknown='ignore'` para evitar erros caso apare√ßa uma nova cidade no novo dataset que n√£o estava nos dados de treino.

---

### üîπ 6. Padroniza√ß√£o dos dados num√©ricos

```python
scaler = StandardScaler()
df_processado[colunas_numericas] = scaler.fit_transform(df_processado[colunas_numericas])
```

- Muitos modelos de Machine Learning exigem que os dados num√©ricos estejam na mesma escala.
- O `StandardScaler` **padroniza os valores**, ou seja, transforma-os para ter m√©dia zero e desvio padr√£o igual a 1.
- Isso evita que colunas com n√∫meros muito grandes (ex: renda em reais) dominem o modelo.

---

### üîπ 7. Fazer previs√µes com o modelo carregado

```python
previsoes = modelo.predict(df_processado)
```

- Com os dados preparados (sem valores faltantes, codificados e padronizados), podemos **usar o modelo para fazer previs√µes**.
- A fun√ß√£o `predict()` retorna a **categoria prevista** para cada linha do dataset.

---

### üîπ 8. Adicionar as previs√µes ao dataset original

```python
df_novo['categoria_prevista'] = previsoes
```

- Criamos uma nova coluna chamada `'categoria_prevista'` no dataframe original (`df_novo`) e colocamos l√° as previs√µes feitas pelo modelo.

---

### üîπ 9. Exibir resultado final

```python
print("\nNovo dataset com previs√µes:")
print(df_novo[['id', 'categoria_prevista']])
```

- Mostramos apenas algumas colunas do dataset final, para vermos os resultados de forma mais clara.
- Supondo que o dataset tenha uma coluna `'id'`, mostramos o ID do aluno e a categoria prevista.

---

## ‚úÖ Resumo do Processo

| Etapa | O que fizemos |
|-------|---------------|
| 1. Carregar o modelo | Pegamos o modelo treinado |
| 2. Carregar os dados | Leitura do novo dataset |
| 3. Tratar valores faltantes | Preenchemos campos vazios nas colunas num√©ricas |
| 4. Codificar vari√°veis categ√≥ricas | Transformamos texto em n√∫meros |
| 5. Padronizar os dados | Colocamos os n√∫meros na mesma escala |
| 6. Fazer previs√µes | Usamos o modelo para prever o que faltava |
| 7. Salvar e mostrar o resultado | Inserimos as previs√µes no dataset |

---

## üí° Dica Final para Alunos

Se voc√™ est√° come√ßando:

- Entenda primeiro o que √© um **modelo de Machine Learning** (√© como uma "caixa preta" que aprende com dados antigos para tomar decis√µes).
- Pratique com datasets pequenos e veja como os dados mudam em cada etapa.
- Use fun√ß√µes como `print()` para visualizar o que acontece em cada passo ‚Äî isso ajuda a entender melhor!

---

Se quiser, posso te ajudar a criar um exemplo pr√°tico com um dataset pequeno, para voc√™ testar esse c√≥digo na pr√°tica. √â s√≥ pedir!