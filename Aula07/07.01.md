# üìò Redes Neurais Convolucionais (CNN)

## üéØ Objetivos da Aula

Ao final desta aula, seremos capazes de:

- Entender **o que s√£o** Redes Neurais Convolucionais (CNN).
- Compreender os **principais componentes** de uma CNN.
- Saber por que as CNNs s√£o t√£o boas para vis√£o computacional.
- Aplicar uma CNN simples em um problema real, como **classifica√ß√£o de imagens**.

## üß† O Que √â Uma Rede Neural Convolucional?

Uma **Rede Neural Convolucional (Convolutional Neural Network ou CNN)** √© um tipo especializado de rede neural artificial projetada para trabalhar com dados que possuem uma estrutura espacial, como **imagens**.

### Por que usar CNN?
Diferente das redes neurais tradicionais, as CNNs:
- **Capturam padr√µes locais** (como bordas, cantos, formas simples).
- **Reconhecem objetos mesmo se estiverem em posi√ß√µes diferentes na imagem** (invari√¢ncia translacional).
- S√£o mais eficientes, pois **compartilham pesos** durante a extra√ß√£o de caracter√≠sticas.

## üß± Componentes Fundamentais de uma CNN

Vamos entender cada parte importante de uma CNN:

### 1. Camadas Convolucionais (`Conv2D`)

A **camada convolucional** √© respons√°vel por **detectar caracter√≠sticas visuais espec√≠ficas** nas imagens, como bordas, texturas, formas simples, etc.

#### üîç Como Funciona?

Ela usa pequenos filtros (ou *kernels*) que "varrem" a imagem, fazendo opera√ß√µes matem√°ticas para identificar padr√µes locais.

##### Exemplo visual:

Imagina que temos uma imagem em escala de cinza de 5x5 pixels:

```
[0 0 0 0 0
 0 1 1 1 0
 0 1 1 1 0
 0 1 1 1 0
 0 0 0 0 0]
```

Se aplicarmos um filtro que detecta bordas verticais:

```
[-1 0 1
 -1 0 1
 -1 0 1]
```

O resultado mostrar√° onde est√£o essas bordas na imagem original.

> üí° **Exemplo Pr√°tico em Python (Keras):**

```python
from tensorflow.keras.layers import Conv2D

# Suponha uma imagem de entrada 32x32 com 3 canais (RGB)
input_shape = (32, 32, 3)

# Criando uma camada convolucional com 32 filtros de tamanho 3x3
conv_layer = Conv2D(filters=32, kernel_size=(3, 3), activation='relu', input_shape=input_shape)
```

Cada filtro extrai uma caracter√≠stica diferente!

### 2. Opera√ß√µes de Pooling (`MaxPooling2D`)

Depois de extrair caracter√≠sticas, queremos **reduzir a dimensionalidade** da imagem, mantendo as informa√ß√µes mais importantes.

O **max pooling** √© uma t√©cnica popular que reduz a resolu√ß√£o da imagem, pegando o valor m√°ximo dentro de blocos pequenos.

#### Exemplo Visual:

Matriz original:
```
[1 2 3 4
 5 6 7 8
 9 10 11 12
13 14 15 16]
```

Ap√≥s MaxPooling com janela 2x2:
```
[6 8
14 16]
```

> ‚úÖ Isso torna o modelo mais r√°pido e menos sens√≠vel a pequenas varia√ß√µes na posi√ß√£o dos objetos.

##### Exemplo em Python:

```python
from tensorflow.keras.layers import MaxPooling2D

pooling_layer = MaxPooling2D(pool_size=(2, 2))
```

### 3. Camadas Totalmente Conectadas (`Dense`)

Depois de extrair e resumir as caracter√≠sticas com **convolu√ß√£o** e **pooling**, conectamos tudo a **camadas densas**, que realizam a **classifica√ß√£o final**.

Essas camadas funcionam como em redes neurais tradicionais: todos os neur√¥nios se conectam a todos os neur√¥nios da camada anterior.

##### Exemplo:

```python
from tensorflow.keras.layers import Dense, Flatten

flatten_layer = Flatten()  # Transforma a sa√≠da 2D em 1D
dense_layer1 = Dense(128, activation='relu')
dense_layer2 = Dense(10, activation='softmax')  # Para 10 classes
```

## üèóÔ∏è Arquitetura Geral de uma CNN

Um exemplo de arquitetura t√≠pica pode ser:

1. Entrada: Imagem (ex: 32x32 RGB)
2. Camada Convolucional + ReLU
3. MaxPooling
4. Camada Convolucional + ReLU
5. MaxPooling
6. Flatten (Transforma a sa√≠da 2D em 1D)
7. Camada Densa
8. Sa√≠da (Classifica√ß√£o)

---

## üì∑ Aplica√ß√µes Pr√°ticas das CNNs

As CNNs s√£o amplamente usadas em:

| Aplica√ß√£o                     | Descri√ß√£o |
|------------------------------|-----------|
| **Classifica√ß√£o de Imagens** | Identifica qual objeto aparece na imagem (ex: gato vs cachorro) |
| **Detec√ß√£o de Objetos**      | Localiza e identifica m√∫ltiplos objetos na mesma imagem |
| **Segmenta√ß√£o Sem√¢ntica**    | Identifica pixel a pixel o que √© cada parte da imagem |
| **Reconhecimento Facial**    | Verifica identidades com base em fotos |
| **OCR (Reconhecimento de Texto)** | Extrai texto de imagens |



## üß™ Exemplo Pr√°tico: Classifica√ß√£o de Imagens com CIFAR-10

> Utilizar o Jupyter Notebook

Vamos construir uma CNN simples para classificar imagens do dataset **CIFAR-10**, que cont√©m 10 categorias de objetos (avi√µes, carros, p√°ssaros, etc.).

### Passo 1: Importar bibliotecas

```python
import tensorflow as tf
from tensorflow.keras import layers, models
```

### Passo 2: Carregar o dataset

```python
(x_train, y_train), (x_test, y_test) = tf.keras.datasets.cifar10.load_data()

# Normalizar os valores dos pixels entre 0 e 1
x_train = x_train.astype('float32') / 255
x_test = x_test.astype('float32') / 255

# Converter r√≥tulos para one-hot encoding
y_train = tf.keras.utils.to_categorical(y_train, 10)
y_test = tf.keras.utils.to_categorical(y_test, 10)
```

### Passo 3: Criar o modelo CNN

```python
model = models.Sequential()

# Primeira camada convolucional + pooling
model.add(layers.Conv2D(32, (3, 3), activation='relu', input_shape=(32, 32, 3)))
model.add(layers.MaxPooling2D((2, 2)))

# Segunda camada convolucional + pooling
model.add(layers.Conv2D(64, (3, 3), activation='relu'))
model.add(layers.MaxPooling2D((2, 2)))

# Terceira camada convolucional
model.add(layers.Conv2D(64, (3, 3), activation='relu'))

# Achatar para passar para camadas densas
model.add(layers.Flatten())

# Camadas densas finais
model.add(layers.Dense(64, activation='relu'))
model.add(layers.Dense(10, activation='softmax'))  # 10 classes
```

### Passo 4: Compilar o modelo

```python
model.compile(optimizer='adam',
              loss='categorical_crossentropy',
              metrics=['accuracy'])
```

### Passo 5: Treinar o modelo

```python
history = model.fit(x_train, y_train, epochs=5, batch_size=64, validation_split=0.2)
```

### Passo 6: Avaliar o modelo

```python
test_loss, test_acc = model.evaluate(x_test, y_test, verbose=2)
print(f'Acur√°cia no teste: {test_acc:.2f}')
```

## üßë‚Äçüè´ Resumo Final

| Conceito                    | Explica√ß√£o |
|----------------------------|------------|
| **CNN**                    | Tipo especializado de rede neural para processamento de imagens |
| **Camada Convolucional**   | Detecta caracter√≠sticas locais (bordas, formas) |
| **Pooling**                | Reduz dimensionalidade, mantendo informa√ß√µes relevantes |
| **Flatten**                | Transforma sa√≠das 2D em vetores para camadas densas |
| **Densa/Softmax**          | Realiza classifica√ß√£o final |
| **Aplica√ß√µes**             | Classifica√ß√£o, detec√ß√£o de objetos, reconhecimento facial, etc. |

